import{a as t}from"dist/c/c-TRUED2VQ.js";import{a as o,b as p,c as r,d as w}from"dist/c/c-7IWG2BVW.js";import{a as h}from"dist/c/c-VNKROIVZ.js";import"dist/c/c-KBGA43VD.js";import"dist/c/c-IMMAZ5V6.js";import"dist/c/c-GKMUSAHJ.js";import"dist/c/c-APJE67RM.js";import{a as e,b as u}from"dist/c/c-CZWVIXQR.js";import"dist/c/c-NENDH76W.js";import"dist/c/c-MM4QDY4C.js";import"dist/c/c-FRDVAC6P.js";import"dist/c/c-NOIFHIQI.js";import"dist/c/c-FK5OVGWM.js";import"dist/c/c-TZUTJDVS.js";import"dist/c/c-3E2ALMRI.js";import"dist/c/c-GDKDTAPO.js";import"dist/c/c-D4FJECGV.js";import"dist/c/c-J2LR27TH.js";import"dist/c/c-LW7ZHPL2.js";import"dist/c/c-LECXSGS2.js";import"dist/c/c-QG73IUPX.js";import"dist/c/c-TRAMVNXD.js";import"dist/c/c-VCYABVGR.js";import"dist/c/c-ILKXH3EU.js";import"dist/c/c-THLH6QEI.js";import"dist/c/c-Q2M4LT2Y.js";import"dist/c/c-DUBDCQPG.js";import"dist/c/c-C4ELSJGK.js";import"dist/c/c-WJU64RT4.js";import"dist/c/c-P7TDYH2K.js";import{a as g}from"dist/c/c-GHXNGV7G.js";import"dist/c/c-R2ZIKGWF.js";import"dist/c/c-EK65EX7D.js";import"dist/c/c-WZT27OBV.js";import"dist/c/c-J52F52RJ.js";import"dist/c/c-4DXBADYR.js";import"dist/c/c-AQIECKQR.js";import"dist/c/c-MVSRRX3B.js";import"dist/c/c-KNUKJBB6.js";import"dist/c/c-JBU3E5FJ.js";import"dist/c/c-SMKCRPB7.js";import"dist/c/c-NKKTLFPU.js";import"dist/c/c-DVXLCNRC.js";import"dist/c/c-SPO4YIJK.js";import"dist/c/c-IKQSP3I5.js";import"dist/c/c-IOID33GM.js";import"dist/c/c-YDQL54SX.js";import{a as c}from"dist/c/c-4MHJC562.js";import{b as a}from"dist/c/c-O6VQZMRI.js";import"dist/c/c-43Y5K2SV.js";import"dist/c/c-Q5O4ZW2A.js";import{d as i}from"dist/c/c-FP2E5KKM.js";var n=i(c()),s=i(a()),l=i(g());p();u();w();var m=t.extend({render:function(){return this.rendered=!0,this.template=h["template-viewer-widget-background"],this.setElement(this.template({data:this})),this.$el.prependTo(this.page.$fixedBgContainer),this.$picture=this.$(".picture-background"),this.$video=this.$(".video-background"),this.$videoContainer=this.$(".video-container"),this.$slideshow=this.$(".slideshow-container"),this.$slideshowPreload=this.$(".slideshow-preload"),this.picture&&this.selectedType==="picture"?this.renderPicture():!s.default.isEmpty(this.video)&&this.selectedType==="video"?this.renderVideo():this.slideshow&&this.selectedType==="slideshow"?this.renderSlideshow():this.widgetIsLoaded(),this},start:function(){return this.started=!0,this.selectedType==="video"&&!RM.screenshot&&this.rendered&&this.videoWidget&&!this.destroyed&&this.videoWidget.start(),this.selectedType==="slideshow"&&!RM.screenshot&&this.rendered&&!this.destroyed&&this.slideshowWidget&&!this.slideshowWidget.isAnimationRunning&&this.slideshowWidget.startAnimationLoop(),this},stop:function(){return this.started=!1,this.selectedType==="video"&&!RM.screenshot&&this.rendered&&this.videoWidget&&!this.destroyed&&this.videoWidget.stop(),this.selectedType==="slideshow"&&!RM.screenshot&&this.rendered&&!this.destroyed&&this.slideshowWidget&&this.slideshowWidget.isAnimationRunning&&this.slideshowWidget.stopAnimationLoop(),this},destroy:function(){return this.selectedType==="video"&&(this.videoWidget&&this.videoWidget.destroy(),this.videoWidget=null),this.selectedType==="slideshow"&&(this.slideshowWidget&&this.slideshowWidget.destroy(),this.slideshowWidget=null),t.prototype.destroy.apply(this,arguments)},hasVideoBG:function(){return!!(!RM.screenshot&&this.selectedType==="video"&&this.video&&this.video.url)},renderPicture:function(){if(!this.picture){this.widgetIsLoaded();return}let d=e.useLambdaUrl(this.picture)||e.useLambdaUrlOldProjects(this.picture,"background")?e.getLambdaUrl(this.picture):this.picture.finalUrl||this.picture.effectUrl||this.picture.unscaledOptimizedUrl||this.picture.url;(0,n.default)("<img/>").on("load",s.default.bind(function(){this.$picture.css({"background-image":"url("+d+")"}),RM.screenshot?setTimeout(this.widgetIsLoaded,200):this.widgetIsLoaded()},this)).on("error",this.widgetIsLoaded).attr("src",d)},renderSlideshow:function(){this.slideshowWidget=new o({data:this.slideshow,container:this.$slideshow,preloadContainer:this.$slideshowPreload,name:this.page.cid}),RM.screenshot?(this.slideshowWidget.render(),this.slideshowWidget.on("loaded",function(){this.widgetIsLoaded()}.bind(this))):(this.slideshowWidget.render(!this.page.isCurrent()),this.widgetIsLoaded())},renderVideo:function(){this.videoWidget=new r({el:this.$videoContainer.get(0),model:new l.default.Model({video:this.video}),attributes:{thumbnailMode:window.RM.screenshot}}),this.videoWidget.on("loaded",()=>{this.widgetIsLoaded()}),this.videoWidget.on("playStarted",()=>{this.trigger("videoBGStarted")}),this.videoWidget.render()}}),b=m;export{b as default};
